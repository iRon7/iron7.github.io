<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Read Me - Power$nippets</title>
<meta name="description" content="Boost your shell with reusable code stripped to its essentials">
<meta name="generator" content="Hugo 0.72.0" />
<link rel="shortcut icon" href="/images/favicons/favicon.ico">
<link href="https://powersnippets.com//index.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://powersnippets.com/convertto-expression/readme/">
<link rel="stylesheet" href="https://powersnippets.com/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://powersnippets.com/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="https://powersnippets.com/js/bundle.js"></script>
<link href="https://powersnippets.com/css/custom.css" rel="stylesheet">
<style>
:root {--custom-font-color: #f4f4f4;--custom-background-color: #012345;}
</style>
<meta property="og:title" content="Read Me" />
<meta property="og:description" content="ConvertTo-Expression Serializes an object to a PowerShell expression
The ConvertTo-Expression cmdlet converts (serializes) an object to a PowerShell expression. The object can be stored in a variable, file or any other common storage for later use or to be ported to another system.
Converting back from an expression An expression can be restored to an object using the native Invoke-Expression cmdlet:
$Object = Invoke-Expression ($Object | ConverTo-Expression) Or Converting it to a [ScriptBlock] and invoking it with cmdlets along with Invoke-Command or using the call operator (&amp;):" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://powersnippets.com/convertto-expression/readme/" />
<meta property="article:published_time" content="2017-11-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-06-29T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Read Me"/>
<meta name="twitter:description" content="ConvertTo-Expression Serializes an object to a PowerShell expression
The ConvertTo-Expression cmdlet converts (serializes) an object to a PowerShell expression. The object can be stored in a variable, file or any other common storage for later use or to be ported to another system.
Converting back from an expression An expression can be restored to an object using the native Invoke-Expression cmdlet:
$Object = Invoke-Expression ($Object | ConverTo-Expression) Or Converting it to a [ScriptBlock] and invoking it with cmdlets along with Invoke-Command or using the call operator (&amp;):"/>
<meta itemprop="name" content="Read Me">
<meta itemprop="description" content="ConvertTo-Expression Serializes an object to a PowerShell expression
The ConvertTo-Expression cmdlet converts (serializes) an object to a PowerShell expression. The object can be stored in a variable, file or any other common storage for later use or to be ported to another system.
Converting back from an expression An expression can be restored to an object using the native Invoke-Expression cmdlet:
$Object = Invoke-Expression ($Object | ConverTo-Expression) Or Converting it to a [ScriptBlock] and invoking it with cmdlets along with Invoke-Command or using the call operator (&amp;):">
<meta itemprop="datePublished" content="2017-11-06T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-06-29T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="642">



<meta itemprop="keywords" content="" />
<link href="https://powersnippets.com/css/custom.css" rel="stylesheet"></head>
<body><div class="container"><header>
<h1>Power$nippets</h1>

<p class="description">Boost your shell with reusable code stripped to its essentials</p>

</header>

<div class="content-container">
<main>
<h2 id="convertto-expression">ConvertTo-Expression</h2>
<p>Serializes an object to a PowerShell expression</p>
<p>The ConvertTo-Expression cmdlet converts (serializes) an object to
a PowerShell expression. The object can be stored in a variable,
file or any other common storage for later use or to be ported to
another system.</p>
<h4 id="converting-back-from-an-expression">Converting back <em>from</em> an expression</h4>
<p>An expression can be restored to an object using the native
<code>Invoke-Expression</code> cmdlet:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#b8860b">$Object</span> = <span style="color:#a2f">Invoke-Expression</span> (<span style="color:#b8860b">$Object</span> | ConverTo-Expression)
</code></pre></div><p>Or Converting it to a <code>[ScriptBlock]</code> and invoking it with cmdlets
along with <code>Invoke-Command</code> or using the call operator (<code>&amp;</code>):</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#b8860b">$Object</span> = &amp;(<span style="color:#800">[ScriptBlock]</span>::Create(<span style="color:#b8860b">$Object</span> | ConverTo-Expression))
</code></pre></div><p>An expression that is stored in a PowerShell (<code>.ps1</code>) file might also
be directly invoked by the PowerShell dot-sourcing technique, e.g.:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#b8860b">$Object</span> | <span style="color:#a2f">ConvertTo-Expression</span> | <span style="color:#a2f">Out-File</span> .\Expression.ps1
<span style="color:#b8860b">$Object</span> = . .\Expression.ps1
</code></pre></div><p><em><strong>Warning:</strong></em> Invoking partly trusted input with Invoke-Expression or
<code>[ScriptBlock]::Create()</code> methods could be abused by malicious code
injections.</p>
<h2 id="examples">Examples</h2>
<p>Convert a Calendar object to a PowerShell expression:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#a2f">PS </span>C:\&gt; (<span style="color:#a2f">Get-UICulture</span>).Calendar | <span style="color:#a2f">ConvertTo-Expression</span>

<span style="color:#800">[pscustomobject]</span>@{
	<span style="color:#b44">&#39;AlgorithmType&#39;</span> = 1
	<span style="color:#b44">&#39;CalendarType&#39;</span> = 1
	<span style="color:#b44">&#39;Eras&#39;</span> = ,1
	<span style="color:#b44">&#39;IsReadOnly&#39;</span> = <span style="color:#b8860b">$False</span>
	<span style="color:#b44">&#39;MaxSupportedDateTime&#39;</span> = <span style="color:#800">[datetime]</span><span style="color:#b44">&#39;9999-12-31T23:59:59.9999999&#39;</span>
	<span style="color:#b44">&#39;MinSupportedDateTime&#39;</span> = <span style="color:#800">[datetime]</span><span style="color:#b44">&#39;0001-01-01T00:00:00.0000000&#39;</span>
	<span style="color:#b44">&#39;TwoDigitYearMax&#39;</span> = 2029
}

<span style="color:#a2f">PS </span>C:\&gt; (<span style="color:#a2f">Get-UICulture</span>).Calendar | <span style="color:#a2f">ConvertTo-Expression</span> -Strong

<span style="color:#800">[pscustomobject]</span>@{
	<span style="color:#b44">&#39;AlgorithmType&#39;</span> = <span style="color:#800">[System.Globalization.CalendarAlgorithmType]</span><span style="color:#b44">&#39;SolarCalendar&#39;</span>
	<span style="color:#b44">&#39;CalendarType&#39;</span> = <span style="color:#800">[System.Globalization.GregorianCalendarTypes]</span><span style="color:#b44">&#39;Localized&#39;</span>
	<span style="color:#b44">&#39;Eras&#39;</span> = <span style="color:#800">[array][int]</span>1
	<span style="color:#b44">&#39;IsReadOnly&#39;</span> = <span style="color:#800">[bool]</span><span style="color:#b8860b">$False</span>
	<span style="color:#b44">&#39;MaxSupportedDateTime&#39;</span> = <span style="color:#800">[datetime]</span><span style="color:#b44">&#39;9999-12-31T23:59:59.9999999&#39;</span>
	<span style="color:#b44">&#39;MinSupportedDateTime&#39;</span> = <span style="color:#800">[datetime]</span><span style="color:#b44">&#39;0001-01-01T00:00:00.0000000&#39;</span>
	<span style="color:#b44">&#39;TwoDigitYearMax&#39;</span> = <span style="color:#800">[int]</span>2029
}
</code></pre></div><p>Save an object in a file and to restore it later:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#a2f">PS </span>C:\&gt;<span style="color:#a2f">Get-Date</span> | <span style="color:#a2f">Select-Object</span> -Property * | <span style="color:#a2f">ConvertTo-Expression</span> | <span style="color:#a2f">Out-File</span> .\Now.ps1

<span style="color:#a2f">PS </span>C:\&gt;<span style="color:#b8860b">$Now</span> = .\Now.ps1	<span style="color:#080;font-style:italic"># Simular to: $Now = Get-Content .\Now.Ps1 -Raw | Invoke-Expression</span>

<span style="color:#a2f">PS </span>C:\&gt;<span style="color:#b8860b">$Now</span>

Date        <span style="">:</span> 1963-10-07 12<span style="">:</span>00<span style="">:</span>00 AM
DateTime    <span style="">:</span> Monday, October 7, 1963 10<span style="">:</span>47<span style="">:</span>00 PM
Day         <span style="">:</span> 7
DayOfWeek   <span style="">:</span> Monday
DayOfYear   <span style="">:</span> 280
DisplayHint <span style="">:</span> DateTime
Hour        <span style="">:</span> 22
Kind        <span style="">:</span> Local
Millisecond <span style="">:</span> 0
Minute      <span style="">:</span> 22
Month       <span style="">:</span> 1
Second      <span style="">:</span> 0
Ticks       <span style="">:</span> 619388596200000000
TimeOfDay   <span style="">:</span> 22<span style="">:</span>47<span style="">:</span>00
Year        <span style="">:</span> 1963
</code></pre></div><p>Compress the PowerShell expression output:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#a2f">PS </span>C:\&gt;@{Account=<span style="color:#b44">&#34;User01&#34;</span>;Domain=<span style="color:#b44">&#34;Domain01&#34;</span>;Admin=<span style="color:#b44">&#34;True&#34;</span>} | <span style="color:#a2f">ConvertTo-Expression</span> -Expand -1	

@{<span style="color:#b44">&#39;Admin&#39;</span>=<span style="color:#b44">&#39;True&#39;</span>;<span style="color:#b44">&#39;Account&#39;</span>=<span style="color:#b44">&#39;User01&#39;</span>;<span style="color:#b44">&#39;Domain&#39;</span>=<span style="color:#b44">&#39;Domain01&#39;</span>}
</code></pre></div><p>Convert the WinInit Process to a PowerShell expression:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#a2f">PS </span>C:\&gt;WinInitProcess = <span style="color:#a2f">Get-Process</span> WinInit | <span style="color:#a2f">ConvertTo-Expression</span>
</code></pre></div><p>Reveal complex object hierarchies:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell"><span style="color:#a2f">PS </span>C:\&gt;<span style="color:#a2f">Get-Host</span> | <span style="color:#a2f">ConvertTo-Expression</span> -Depth 4
</code></pre></div><h2 id="inputs">Inputs</h2>
<p><code>Any</code>. Each objects provided through the pipeline will converted to an
expression. To concatinate all piped objects in a single expression,
use the unary comma operator, e.g.: <code>,$Object | ConvertTo-Expression</code></p>
<h2 id="outputs">Outputs</h2>
<p><code>String[]</code>. ConvertTo-Expression returns a PowerShell expression for
each input object.</p>
<h2 id="parameters">Parameters</h2>
<p><code>-InputObject</code><br>
Specifies the objects to convert to a PowerShell expression. Enter
a variable that contains the objects, or type a command or
expression that gets the objects. You can also pipe one or more
objects to <code>ConvertTo-Expression</code>.</p>
<p><code>-Depth</code><br>
Specifies how many levels of contained objects are included in the 
PowerShell representation. The default value is <code>9</code>.</p>
<p><code>-Expand</code><br>
Specifies till what level the contained objects are expanded over
separate lines and indented according to the <code>-Indentation</code> and 
<code>-IndentChar</code> parameters. The default value is <code>9</code>.</p>
<p>A negative value will remove redundant spaces and compress the
PowerShell expression to a single line (except for multi-line
strings).</p>
<p>Xml documents and multi-line strings are embedded in a
&ldquo;here string&rdquo; and aligned to the left.</p>
<p><code>-Indentation</code><br>
Specifies how many IndentChars to write for each level in the hierarchy.</p>
<p><code>-IndentChar</code><br>
Specifies which character to use for indenting.</p>
<p><code>-Strong</code><br>
By default, the <code>ConvertTo-Expression</code> cmdlet will return a weakly typed
expression which is best for transfing objects between differend
PowerShell systems.
The <code>-Strong</code> parameter will strickly define value types and objects
in a way that they can still be read by same PowerShell system and
PowerShell system with the same configuration (installed modules etc.).</p>
<p><code>-Explore</code><br>
In explore mode, all type prefixes are omitted in the output expression
(objects will cast to to hash tables). In case the <code>-Strong</code> parameter is
also supplied, all <em>orginal</em> (.Net) type names are shown.
The <code>-Explore</code> switch is usefull for exploring object hyrachies and data
type, not for saving and transfering objects.</p>
<p><code>-NewLine</code><br>
Specifies which characters to use for a new line. The default is defined by
the operating system.</p>
<div class="edit-meta">
Last updated on 29 Jun 2020


<br>
Published on 6 Nov 2017
<br></div><nav class="pagination"><a class="nav nav-prev" href="https://powersnippets.com/convertto-expression/" title="ConvertTo-Expression"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - ConvertTo-Expression</a>
<a class="nav nav-next" href="https://powersnippets.com/convertto-expression/source/" title="Source &amp; download">Next - Source &amp; download <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer>
</footer>
</main><div class="sidebar">

<nav class="slide-menu">
<ul>
<li class=""><a href="https://powersnippets.com/">Home</a></li>

<li class=" has-sub-menu"><a href="https://powersnippets.com/convertfrom-sourcetable/">ConvertFrom-SourceTable<span class="mark closed">+</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://powersnippets.com/convertfrom-sourcetable/readme/">Read Me</a></li>
<li class=""><a href="https://powersnippets.com/convertfrom-sourcetable/source/">Source &amp; download</a></li>
</ul>
  
</li>

<li class=" has-sub-menu"><a href="https://powersnippets.com/convertto-datatable/">ConvertTo-DataTable<span class="mark closed">+</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://powersnippets.com/convertto-datatable/readme/">Read Me</a></li>
</ul>
  
</li>

<li class="parent has-sub-menu"><a href="https://powersnippets.com/convertto-expression/">ConvertTo-Expression<span class="mark opened">-</span></a>
  
<ul class="sub-menu">
<li class="active"><a href="https://powersnippets.com/convertto-expression/readme/">Read Me</a></li>
<li class=""><a href="https://powersnippets.com/convertto-expression/source/">Source &amp; download</a></li>
</ul>
  
</li>

<li class=""><a href="https://powersnippets.com/convertto-flatobject/">ConvertTo-FlatObject</a>
  
</li>

<li class=""><a href="https://powersnippets.com/create-string/">Create-String</a>
  
</li>

<li class=""><a href="https://powersnippets.com/inline-if-iif/">Inline (IIf)</a>
  
</li>

<li class=""><a href="https://powersnippets.com/invoke-comobject/">Invoke-ComObject</a>
  
</li>

<li class=" has-sub-menu"><a href="https://powersnippets.com/join-object/">Join-Object<span class="mark closed">+</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://powersnippets.com/join-object/readme/">Read Me</a></li>
<li class=""><a href="https://powersnippets.com/join-object/source/">Source &amp; download</a></li>
</ul>
  
</li>

<li class=""><a href="https://powersnippets.com/merge-hashtable/">Merge-Hashtable</a>
  
</li>

<li class=""><a href="https://powersnippets.com/set-formcontrol/">Set-FormControl</a>
  
</li>

<li class=""><a href="https://powersnippets.com/union-object/">Union-Object</a>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"><h2>WhoAmI</h2>
<p>
<img align="left" src="/images/WhoAmI.jpg" alt width="74" height="96" />
My name is Ronald Bode.<br />
I am a Windows engineer and developer.
</p>
<p>
Code writing is my hobby and I love riddles. Currently I am most active with PowerShell programming, RPA (UiPath) and creating webpages.
</p>
<a href="https://www.linkedin.com/in/ronald-bode-4a1156124/"><img src="/images/icons/linkedin.png" width="16" />LinkedIn</a>
<a href="https://stackoverflow.com/users/1701026/iron/"><img src="/images/icons/stackoverflow.png" width="16" />StackOverflow</a>
<a href="https://github.com/iRon7/"><img src="/images/icons/github.png" width="16" />GitHub</a></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
